<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>{{ block "title" . }}Webhook Tester{{ end }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs" defer></script>
    <script src="/static/js/script.js"></script>
</head>
<body class="bg-gray-100 text-gray-900 flex flex-col min-h-screen">

<!-- Top Navbar -->
<header class="bg-white border-b shadow-sm py-3 px-6 flex justify-between items-center">
    <a href="/" class="text-xl font-bold text-blue-600">
        Webhook Tester
    </a>
    <nav class="space-x-4 text-sm text-gray-700">
        <a href="/" class="hover:text-blue-600">Home</a>
        <a href="/how-to" class="hover:text-blue-600">How To</a>
        <a href="/docs" class="hover:text-blue-600">API Docs</a>
        <a href="/login" class="hover:text-blue-600">Login</a>
        <a href="/register" class="text-blue-600 font-medium hover:underline">Register</a>
    </nav>
</header>

<!-- Main Layout: Sidebar + Main Content -->
<div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-80 bg-white border-r flex flex-col">
        <!-- Default Webhook Info -->
        <div class="px-6 pt-6 pb-2 text-xs text-gray-500 uppercase tracking-wide">
            Webhooks
        </div>
        <div
                x-data="sseRequestStream('{{ .Webhook.ID }}')"
                x-init="connect()"
                class="px-6 pb-4"
        >
            <a href="/?address={{ .Webhook.ID }}"
               class="w-full flex bg-gray-100 p-2 rounded text-sm font-mono break-all">
                {{ .Webhook.ID }}
            </a>
        </div>

        <!-- Recent Requests  -->
        <div class="px-6 pb-2 text-xs text-gray-500 uppercase tracking-wide">Recent Requests</div>
        <div class="flex-1 overflow-y-auto px-6 space-y-2 text-sm" id="request-log">
            {{ range .Webhook.Requests }}
            <a href="/requests/{{ .ID }}?address={{ .WebhookID }}"
               class="flex flex-row gap-2  p-2 rounded border hover:bg-blue-50 hover:border-blue-200 cursor-pointer">
                <div class="text-xs text-gray-600 font-medium">{{ .Method }}</div>
                <div class="text-blue-600 font-mono text-xs break-all">{{ .ID }}</div>
            </a>
            {{ else }}
            <p class="text-xs text-gray-400 italic">No requests yet.</p>
            {{ end }}
        </div>

        <!-- Sidebar Footer -->
        <div class="p-6 border-t text-sm space-y-2">
            <a href="/feedback" class="block text-blue-600 hover:underline">‚≠ê Feedback</a>
            <a href="/feature-request" class="block text-blue-600 hover:underline">üõ† Feature Request</a>
        </div>
    </aside>

    <!-- Main Content Area -->
    <div class="flex-1 overflow-y-auto flex flex-col">
        <main class="flex-1 p-6">
            {{ block "content" . }}{{ end }}
        </main>

        <!-- Footer -->
        <footer class="bg-white border-t text-sm text-gray-500 px-6 py-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-5xl mx-auto">
                <div>
                    <h4 class="font-semibold mb-1">Resources</h4>
                    <ul class="space-y-1">
                        <li><a href="/about" class="hover:underline">What is Webhook Tester?</a></li>
                        <li><a href="/use-cases" class="hover:underline">Use Cases</a></li>
                        <li><a href="/faq" class="hover:underline">Key Takeaways</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-1">Legal</h4>
                    <ul class="space-y-1">
                        <li><a href="/privacy" class="hover:underline">Privacy Policy</a></li>
                        <li><a href="/terms" class="hover:underline">Terms & Conditions</a></li>
                    </ul>
                </div>
            </div>
            <p class="text-center text-xs text-gray-400 mt-8">¬© {{ .Year }} Webhook Tester. All rights reserved.</p>
        </footer>
    </div>
</div>

</body>
</html>
